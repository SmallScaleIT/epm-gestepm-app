sql:
  qry-list-of-sgn: |
    
    SELECT *
    FROM (
      SELECT
        cs.construction_share_id AS signing_id,
        cs.created_at AS start_date,
        cs.closed_at AS end_date,
        CONCAT('/shares/construction/', cs.construction_share_id) AS detail_url,
        cs.user_id
      FROM ${sch-gestepm}.construction_share cs
      UNION
      SELECT
        ds.displacement_share_id AS signing_id,
        ds.start_date,
        ds.end_date,
        CONCAT('/shares/displacement/', ds.displacement_share_id) AS detail_url,
        ds.user_id
      FROM ${sch-gestepm}.displacement_share ds
      UNION
      SELECT
        ums.id AS signing_id,
        ums.start_date,
        ums.end_date,
        '' AS detail_url,
        ums.user_id
      FROM ${sch-gestepm}.user_manual_signings ums
      UNION
      SELECT
        prs.personal_signing_id AS signing_id,
        prs.start_date,
        prs.end_date,
        '' AS detail_url,
        prs.user_id
      FROM ${sch-gestepm}.personal_signing prs
      UNION
      SELECT
        ps.programmed_share_id AS signing_id,
        ps.start_date,
        ps.end_date,
        CONCAT('/shares/programmed/', ps.programmed_share_id) AS detail_url,
        ps.user_id
      FROM ${sch-gestepm}.programmed_share ps
      UNION
      SELECT
        ts.teleworking_signing_id AS signing_id,
        ts.started_at AS start_date,
        ts.closed_at AS end_date,
        CONCAT('/signings/teleworking/', ts.teleworking_signing_id) AS detail_url,
        ts.user_id
      FROM ${sch-gestepm}.teleworking_signing ts
      LEFT JOIN ${sch-gestepm}.project pr ON pr.project_id = ts.project_id
      WHERE pr.type = 'OFFICE'
      UNION
      SELECT
        ts.teleworking_signing_id AS signing_id,
        ts.started_at AS start_date,
        ts.closed_at AS end_date,
        CONCAT('/signings/teleworking/', ts.teleworking_signing_id) AS detail_url,
        ts.user_id
      FROM ${sch-gestepm}.teleworking_signing ts
      LEFT JOIN ${sch-gestepm}.project pr ON pr.project_id = ts.project_id
      WHERE pr.type = 'TELEWORKING'
      UNION
      SELECT
        ws.work_share_id AS signing_id,
        ws.start_date,
        ws.end_date,
        CONCAT('/shares/work/', ws.work_share_id) AS detail_url,
        ws.user_id
      FROM ${sch-gestepm}.work_share ws
      UNION
      SELECT
        whs.warehouse_signing_id AS signing_id,
        whs.started_at AS start_date,
        whs.closed_at AS end_date,
        CONCAT('/signings/warehouse/', whs.warehouse_signing_id) AS detail_url,
        whs.user_id
      FROM ${sch-gestepm}.warehouse_signing whs
      UNION
      SELECT
        nps.no_programmed_share_id AS signing_id,
        nps.start_date,
        nps.end_date,
        CONCAT('/shares/no-programmed/', nps.no_programmed_share_id) detail_url,
        nps.user_id
      FROM ${sch-gestepm}.no_programmed_share nps
    ) AS sublist
    
    #whereToken #filter

  filter-current-sgn: |
    
    user_id = :attr_sgn_user_id AND end_date IS NULL
